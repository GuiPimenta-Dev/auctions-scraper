import json
import sys

import requests
from scrapy import Selector


from base import BaseRequests

from auctions.utils.parser import Parser
parser = Parser()


class Caixa(BaseRequests):
    def __init__(self, city, csv_file):
        self.csv_file = csv_file
        self.city = city
        self.states_city_for_each_state = self.generate_states_city_for_each_state()
        response = self.get_url()
        self.parse(response)

    def parse_select_dict(self, raw_select: str, exclude_first_option=False, split_key: str = None,
                          split_value: str = None):
        opt = {}
        raw_selects = raw_select.replace('<option value=', '').replace('"', '').replace('<select>', '').replace(
            '</select>', '').strip().split('</option>')
        if exclude_first_option:
            raw_selects = raw_selects[1:]
        for select in raw_selects:
            if select:
                value, _, key = select.partition('>')
                key = self.normalize_string(key)
                if split_key:
                    key = key.split(split_key)[0]
                if split_value:
                    value = value.split(split_value)[0]
                opt[key] = value.strip()

        return opt

    def generate_states_city_for_each_state(self):
        states_id = {'acre': 'AC', 'alagoas': 'AL', 'amazonas': 'AM', 'amapa': 'AP', 'bahia': 'BA', 'ceara': 'CE',
                     'distrito_federal': 'DF',
                     'espirito_santo': 'ES',
                     'goias': 'GO', 'maranhao': 'MA', 'minas_gerais': 'MG', 'mato_grosso_do_sul': 'MS',
                     'mato_grosso': 'MT',
                     'para': 'PA', 'paraiba': 'PB', 'pernambuco': 'PE', 'piaui': 'PI', 'parana': 'PR',
                     'rio_de_janeiro': 'RJ', 'rio_grande_do_norte': 'RN', 'rondonia': 'RO', 'roraima': 'RR',
                     'rio_grande_do_sul': 'RS',
                     'santa_catarina': 'SC', 'sergipe': 'SE',
                     'sao_paulo': 'SP', 'tocantins': 'TO'}

        acre_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="4">BRASILEIA</option><option value="6">CAPIXABA</option><option value="7">CRUZEIRO DO SUL</option><option value="9">EPITACIOLANDIA</option><option value="10">FEIJO</option><option value="24">RIO BRANCO</option><option value="25">RODRIGUES ALVES</option><option value="28">SENA MADUREIRA</option></select>"""
        alagoas_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="35">ANADIA</option><option value="39">ARAPIRACA</option><option value="40">ATALAIA</option><option value="46">BARRA DE SAO MIGUEL</option><option value="49">BATALHA</option><option value="56">BOCA DA MATA</option><option value="62">CAJUEIRO</option><option value="73">CAPELA</option><option value="77">COITE DO NOIA</option><option value="80">CORURIPE</option><option value="83">DELMIRO GOUVEIA</option><option value="84">DOIS RIACHOS</option><option value="87">FEIRA GRANDE</option><option value="90">FLEXEIRAS</option><option value="93">GIRAU DO PONCIANO</option><option value="94">IBATEGUARA</option><option value="95">IGACI</option><option value="105">JUNQUEIRO</option><option value="107">LAGOA DA CANOA</option><option value="117">LIMOEIRO DE ANADIA</option><option value="118">MACEIO</option><option value="122">MARAVILHA</option><option value="123">MARECHAL DEODORO</option><option value="124">MARIBONDO</option><option value="133">MURICI</option><option value="136">OLHO D'AGUA DAS FLORES</option><option value="138">OLHO D'AGUA DO CASADO</option><option value="142">OURO BRANCO</option><option value="145">PALMEIRA DOS INDIOS</option><option value="149">PASSO DE CAMARAGIBE</option><option value="153">PENEDO</option><option value="155">PILAR</option><option value="156">PINDOBA</option><option value="157">PIRANHAS</option><option value="161">PORTO CALVO</option><option value="165">QUEBRANGULO</option><option value="168">RIO LARGO</option><option value="182">SAO SEBASTIAO</option><option value="185">SATUBA</option><option value="192">TAQUARANA</option><option value="194">TEOTONIO VILELA</option><option value="198">VICOSA</option></select>"""
        amazonas_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="201">ALVARAES</option><option value="210">AUTAZES</option><option value="216">BARCELOS</option><option value="224">BORBA</option><option value="232">CAREIRO</option><option value="245">HUMAITA</option><option value="249">IRANDUBA</option><option value="250">ITACOATIARA</option><option value="258">MANACAPURU</option><option value="260">MANAUS</option><option value="270">NOVO AIRAO</option><option value="273">PARINTINS</option><option value="276">PRESIDENTE FIGUEIREDO</option><option value="278">RIO PRETO DA EVA</option><option value="291">TEFE</option></select>"""
        amapa_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="326">MACAPA</option><option value="335">SANTANA</option></select>"""
        bahia_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="361">ALAGOINHAS</option><option value="415">BARRA DO CHOCA</option><option value="422">BARREIRAS</option><option value="426">BARROCAS</option><option value="476">CACHOEIRA</option><option value="478">CACULE</option><option value="482">CAETITE</option><option value="493">CAMACAN</option><option value="494">CAMACARI</option><option value="495">CAMAMU</option><option value="512">CANDIDO SALES</option><option value="520">CAPIM GROSSO</option><option value="532">CASA NOVA</option><option value="540">CATU</option><option value="547">CICERO DANTAS</option><option value="550">COARACI</option><option value="556">CONCEICAO DO COITE</option><option value="557">CONCEICAO DO JACUIPE</option><option value="564">CORACAO DE MARIA</option><option value="568">CORRENTINA</option><option value="587">DIAS D'AVILA</option><option value="597">ENTRE RIOS</option><option value="599">ESPLANADA</option><option value="600">EUCLIDES DA CUNHA</option><option value="601">EUNAPOLIS</option><option value="604">FEIRA DE SANTANA</option><option value="608">FIRMINO ALVES</option><option value="629">GUANAMBI</option><option value="632">GUARATINGA</option><option value="638">HELIOPOLIS</option><option value="642">IACU</option><option value="660">IBIRATAIA</option><option value="668">IBOTIRAMA</option><option value="683">ILHEUS</option><option value="692">IPIAU</option><option value="693">IPIRA</option><option value="706">ITABERABA</option><option value="707">ITABUNA</option><option value="714">ITAGIBA</option><option value="726">ITAMARAJU</option><option value="728">ITAMBE</option><option value="739">ITAPETINGA</option><option value="747">ITARANTIM</option><option value="752">ITIUBA</option><option value="755">ITUBERA</option><option value="758">JABORANDI</option><option value="764">JAGUAQUARA</option><option value="773">JEQUIE</option><option value="781">JOAO DOURADO</option><option value="784">JUAZEIRO</option><option value="804">LAGOA REAL</option><option value="813">LAPAO</option><option value="815">LAURO DE FREITAS</option><option value="10161">LUIS EDUARDO MAGALHAES</option><option value="825">MACARANI</option><option value="830">MAIQUINIQUE</option><option value="858">MEDEIROS NETO</option><option value="881">MUCURI</option><option value="892">NAZARE</option><option value="905">NOVA VICOSA</option><option value="926">PALMAS DE MONTE ALTO</option><option value="937">PAULO AFONSO</option><option value="942">PEDRO ALEXANDRE</option><option value="966">POCOES</option><option value="968">POJUCA</option><option value="973">PORTO SEGURO</option><option value="977">PRADO</option><option value="996">RIACHO DE SANTANA</option><option value="999">RIBEIRA DO POMBAL</option><option value="1017">SALVADOR</option><option value="1020">SANTA BRIGIDA</option><option value="1025">SANTA MARIA DA VITORIA</option><option value="1029">SANTALUZ</option><option value="1046">SAO GONCALO DOS CAMPOS</option><option value="1066">SENHOR DO BONFIM</option><option value="1070">SERRA DO RAMALHO</option><option value="1075">SERRINHA</option><option value="1108">TEIXEIRA DE FREITAS</option><option value="1117">TUCANO</option><option value="1119">UBAIRA</option><option value="1120">UBAITABA</option><option value="1121">UBATA</option><option value="1146">VITORIA DA CONQUISTA</option></select>"""
        ceara_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="1156">ACOPIARA</option><option value="1186">AQUIRAZ</option><option value="1238">BEBERIBE</option><option value="1248">BOA VIAGEM</option><option value="1259">BREJO SANTO</option><option value="1290">CAPISTRANO</option><option value="1308">CASCAVEL</option><option value="1313">CATUNDA</option><option value="1314">CAUCAIA</option><option value="1317">CEDRO</option><option value="1330">CRATEUS</option><option value="1331">CRATO</option><option value="1363">ERERE</option><option value="1377">FORTALEZA</option><option value="1407">HORIZONTE</option><option value="1427">IGUATU</option><option value="1435">IPU</option><option value="1448">ITAITINGA</option><option value="1453">ITAPIPOCA</option><option value="1482">JUAZEIRO DO NORTE</option><option value="1517">MARACANAU</option><option value="1519">MARANGUAPE</option><option value="1531">MAURITI</option><option value="1547">MOMBACA</option><option value="1591">PACAJUS</option><option value="1592">PACATUBA</option><option value="1608">PARACURU</option><option value="1625">PEDRA BRANCA</option><option value="15445">PEDRA BRANCA</option><option value="1631">PENAFORTE</option><option value="1637">PINDORETAMA</option><option value="1654">PORTEIRAS</option><option value="1667">QUIXADA</option><option value="1670">QUIXERAMOBIM</option><option value="1682">RUSSAS</option><option value="1713">SAO GONCALO DO AMARANTE</option><option value="1727">SAO LUIS DO CURU</option><option value="1753">SOBRAL</option><option value="1762">TABULEIRO DO NORTE</option><option value="1764">TAMBORIL</option><option value="1771">TAUA</option><option value="1772">TEJUCUOCA</option><option value="1777">TRAIRI</option><option value="1794">UMIRIM</option><option value="1798">VARJOTA</option></select>"""
        df_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="1809">BRASILIA</option><option value="1820">CEILANDIA</option><option value="1823">GUARA</option><option value="1824">LAGO NORTE</option><option value="1826">NUCLEO BANDEIRANTE</option><option value="1832">SANTA MARIA</option><option value="1833">SAO SEBASTIAO</option><option value="1834">SOBRADINHO</option><option value="1835">TAGUATINGA</option></select>"""
        es_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="1837">AFONSO CLAUDIO</option><option value="1855">ARACRUZ</option><option value="1863">BAIXO GUANDU</option><option value="1865">BARRA DE SAO FRANCISCO</option><option value="1871">BOA ESPERANCA</option><option value="1879">CACHOEIRO DE ITAPEMIRIM</option><option value="1884">CARIACICA</option><option value="1887">COLATINA</option><option value="1889">CONCEICAO DO CASTELO</option><option value="1901">DOMINGOS MARTINS</option><option value="1909">FUNDAO</option><option value="1919">GUARAPARI</option><option value="1936">ITAGUACU</option><option value="1943">ITAPEMIRIM</option><option value="1956">JERONIMO MONTEIRO</option><option value="1969">MARECHAL FLORIANO</option><option value="1975">MONTANHA</option><option value="1982">MUQUI</option><option value="2002">PINHEIROS</option><option value="2004">PIUMA</option><option value="2046">SAO GABRIEL DA PALHA</option><option value="2069">SERRA</option><option value="2079">VIANA</option><option value="2085">VILA VELHA</option><option value="2089">VITORIA</option></select>"""
        goias_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="2096">AGUAS LINDAS DE GOIAS</option><option value="2097">ALEXANIA</option><option value="2104">AMERICANO DO BRASIL</option><option value="2106">ANAPOLIS</option><option value="2110">APARECIDA DE GOIANIA</option><option value="2116">ARAGARCAS</option><option value="2129">BELA VISTA DE GOIAS</option><option value="2130">BOM JARDIM DE GOIAS</option><option value="2131">BOM JESUS DE GOIAS</option><option value="2132">BONFINOPOLIS</option><option value="2148">CALDAS NOVAS</option><option value="2157">CAMPOS BELOS</option><option value="2166">CATALAO</option><option value="2176">CIDADE OCIDENTAL</option><option value="19359">CLAUDINAPOLIS</option><option value="2179">COCALZINHO DE GOIAS</option><option value="2185">CRISTALINA</option><option value="2187">CRIXAS</option><option value="2202">ESTRELA DO NORTE</option><option value="2207">FORMOSA</option><option value="2215">GOIANESIA</option><option value="2216">GOIANIA</option><option value="2217">GOIANIRA</option><option value="2221">GUAPO</option><option value="2230">INDIARA</option><option value="2231">INHUMAS</option><option value="2235">ISRAELANDIA</option><option value="2238">ITAGUARI</option><option value="2241">ITAPACI</option><option value="2246">ITUMBIARA</option><option value="2250">JARAGUA</option><option value="2251">JATAI</option><option value="2259">JUSSARA</option><option value="2264">LUZIANIA</option><option value="2271">MAURILANDIA</option><option value="2275">MINACU</option><option value="2276">MINEIROS</option><option value="2278">MONTE ALEGRE DE GOIAS</option><option value="2279">MONTES CLAROS DE GOIAS</option><option value="2291">NIQUELANDIA</option><option value="2300">NOVO GAMA</option><option value="2308">PADRE BERNARDO</option><option value="2314">PARANAIGUARA</option><option value="2327">PLANALTINA</option><option value="19087">POSSELANDIA</option><option value="2340">RIO VERDE</option><option value="2350">SANTA HELENA DE GOIAS</option><option value="2352">SANTA RITA DO ARAGUAIA</option><option value="2360">SANTO ANTONIO DO DESCOBERTO</option><option value="2363">SAO FRANCISCO DE GOIAS</option><option value="2369">SAO LUIZ DO NORTE</option><option value="2371">SAO MIGUEL DO ARAGUAIA</option><option value="2373">SAO PATRICIO</option><option value="2392">TRINDADE</option><option value="2398">URUACU</option><option value="2404">VALPARAISO DE GOIAS</option></select>"""
        maranhao_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="2412">ACAILANDIA</option><option value="2422">AMARANTE DO MARANHAO</option><option value="2427">ARAGUANA</option><option value="2430">ARARI</option><option value="2433">BACABAL</option><option value="2438">BALSAS</option><option value="2441">BARRA DO CORDA</option><option value="2451">BOM JARDIM</option><option value="2452">BOM JESUS DAS SELVAS</option><option value="2461">BURITICUPU</option><option value="2470">CAPINZAL DO NORTE</option><option value="2474">CAXIAS</option><option value="2479">CHAPADINHA</option><option value="2481">CODO</option><option value="2486">COROATA</option><option value="2491">DAVINOPOLIS</option><option value="2496">ESTREITO</option><option value="2501">FORTUNA</option><option value="2504">GONCALVES DIAS</option><option value="2505">GOVERNADOR ARCHER</option><option value="2507">GOVERNADOR EUGENIO BARROS</option><option value="2508">GOVERNADOR LUIZ ROCHA</option><option value="2510">GOVERNADOR NUNES FREIRE</option><option value="2512">GRAJAU</option><option value="2514">HUMBERTO DE CAMPOS</option><option value="2519">IMPERATRIZ</option><option value="2522">ITAPECURU MIRIM</option><option value="2524">ITINGA DO MARANHAO</option><option value="2527">JOAO LISBOA</option><option value="2544">MARACACUME</option><option value="2557">MONCAO</option><option value="2566">PACO DO LUMIAR</option><option value="2569">PARAIBANO</option><option value="2571">PASSAGEM FRANCA</option><option value="2572">PASTOS BONS</option><option value="2574">PAULO RAMOS</option><option value="2575">PEDREIRAS</option><option value="2582">PINHEIRO</option><option value="2583">PIO XII</option><option value="2587">PORTO FRANCO</option><option value="2589">PRESIDENTE DUTRA</option><option value="2595">RAPOSA</option><option value="2602">ROSARIO</option><option value="2605">SANTA HELENA</option><option value="2608">SANTA LUZIA DO PARUA</option><option value="2610">SANTA RITA</option><option value="2619">SAO DOMINGOS DO MARANHAO</option><option value="2620">SAO FELIX DE BALSAS</option><option value="2628">SAO JOAO DOS PATOS</option><option value="2630">SAO JOSE DE RIBAMAR</option><option value="2632">SAO LUIS</option><option value="2645">SENADOR ALEXANDRE COSTA</option><option value="2647">SERRANO DO MARANHAO</option><option value="2650">SUCUPIRA DO RIACHAO</option><option value="2653">TIMON</option><option value="2657">TURIACU</option><option value="2658">TURILANDIA</option><option value="2662">VIANA</option><option value="2666">ZE DOCA</option></select>"""
        minas_gerais_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="2667">ABADIA DOS DOURADOS</option><option value="2671">ABRE CAMPO</option><option value="2687">AIMORES</option><option value="2697">ALEM PARAIBA</option><option value="2699">ALFENAS</option><option value="2702">ALMENARA</option><option value="2705">ALTEROSA</option><option value="2724">ANDRADAS</option><option value="2743">ARACUAI</option><option value="2751">ARAUJOS</option><option value="2753">ARAXA</option><option value="2755">ARCEBURGO</option><option value="2757">AREADO</option><option value="2777">BALDIM</option><option value="2778">BAMBUI</option><option value="2782">BARAO DE COCAIS</option><option value="2784">BARBACENA</option><option value="2803">BELO HORIZONTE</option><option value="2811">BETIM</option><option value="2817">BOA ESPERANCA</option><option value="2823">BOM DESPACHO</option><option value="2861">BUGRE</option><option value="2862">BURITIS</option><option value="2863">BURITIZEIRO</option><option value="2883">CAETANOPOLIS</option><option value="2890">CALDAS</option><option value="2893">CAMANDUCAIA</option><option value="2901">CAMPINA VERDE</option><option value="2905">CAMPO BELO</option><option value="2910">CAMPOS ALTOS</option><option value="2911">CAMPOS GERAIS</option><option value="2916">CANAPOLIS</option><option value="2923">CAPELINHA</option><option value="2925">CAPIM BRANCO</option><option value="2931">CAPUTIRA</option><option value="2934">CARANDAI</option><option value="2935">CARANGOLA</option><option value="2936">CARATINGA</option><option value="2947">CARMO DO CAJURU</option><option value="2948">CARMO DO PARANAIBA</option><option value="2949">CARMO DO RIO CLARO</option><option value="2969">CAXAMBU</option><option value="2991">CLAUDIO</option><option value="3004">CONCEICAO DAS ALAGOAS</option><option value="3022">CONFINS</option><option value="3023">CONGONHAL</option><option value="3024">CONGONHAS</option><option value="3027">CONSELHEIRO LAFAIETE</option><option value="3031">CONTAGEM</option><option value="3035">CORACAO DE JESUS</option><option value="3040">COROMANDEL</option><option value="3041">CORONEL FABRICIANO</option><option value="3045">CORREGO DANTA</option><option value="3075">CURVELO</option><option value="3088">DIAMANTINA</option><option value="3094">DIVINO</option><option value="3099">DIVINOPOLIS</option><option value="3101">DIVISA NOVA</option><option value="3102">DIVISOPOLIS</option><option value="3114">DORES DE GUANHAES</option><option value="3115">DORES DO INDAIA</option><option value="3127">ENGENHEIRO CALDAS</option><option value="3138">ESMERALDAS</option><option value="3150">ESTRELA DO SUL</option><option value="3164">FELIXLANDIA</option><option value="3171">FERVEDOURO</option><option value="3180">FORMIGA</option><option value="3195">FRONTEIRA</option><option value="3198">FRUTAL</option><option value="3221">GOVERNADOR VALADARES</option><option value="3224">GRAO MOGOL</option><option value="3226">GRUPIARA</option><option value="3230">GUAPE</option><option value="3242">GUAXUPE</option><option value="3243">GUIDOVAL</option><option value="3252">IAPU</option><option value="3254">IBIA</option><option value="3258">IBIRITE</option><option value="3263">IGARAPE</option><option value="3270">INCONFIDENTES</option><option value="3281">IPATINGA</option><option value="3282">IPIACU</option><option value="3286">ITABIRA</option><option value="3288">ITABIRITO</option><option value="3297">ITAJUBA</option><option value="3308">ITANHANDU</option><option value="3317">ITATIAIUCU</option><option value="3319">ITAUNA</option><option value="3327">ITUIUTABA</option><option value="3329">ITURAMA</option><option value="3331">JABOTICATUBAS</option><option value="3334">JACINTO</option><option value="3340">JAIBA</option><option value="3342">JANAUBA</option><option value="3352">JEQUITINHONHA</option><option value="3356">JOAO MONLEVADE</option><option value="3357">JOAO PINHEIRO</option><option value="3361">JOSE RAYDAN</option><option value="3364">JUATUBA</option><option value="3367">JUIZ DE FORA</option><option value="3377">LAGAMAR</option><option value="3381">LAGOA DOURADA</option><option value="3383">LAGOA GRANDE</option><option value="3384">LAGOA SANTA</option><option value="3385">LAJINHA</option><option value="3386">LAMBARI</option><option value="3393">LAVRAS</option><option value="3396">LEOPOLDINA</option><option value="3413">LUZ</option><option value="3416">MACHADO</option><option value="3428">MANTENA</option><option value="3443">MARTINHO CAMPOS</option><option value="3448">MATEUS LEME</option><option value="3450">MATIAS BARBOSA</option><option value="3454">MATOZINHOS</option><option value="3460">MENDES PIMENTEL</option><option value="3483">MOEMA</option><option value="3490">MONTALVANIA</option><option value="3491">MONTE ALEGRE DE MINAS</option><option value="3492">MONTE AZUL</option><option value="3494">MONTE CARMELO</option><option value="3499">MONTE SIAO</option><option value="3501">MONTES CLAROS</option><option value="3513">MURIAE</option><option value="3514">MUTUM</option><option value="3517">NANUQUE</option><option value="3526">NEPOMUCENO</option><option value="3533">NOVA LIMA</option><option value="3535">NOVA MODICA</option><option value="3538">NOVA RESENDE</option><option value="3539">NOVA SERRANA</option><option value="3545">NOVORIZONTE</option><option value="3553">OLIVEIRA</option><option value="3584">PARA DE MINAS</option><option value="3585">PARACATU</option><option value="3589">PARAISOPOLIS</option><option value="3595">PASSA QUATRO</option><option value="3600">PASSOS</option><option value="3602">PATOS DE MINAS</option><option value="3604">PATROCINIO</option><option value="3605">PATROCINIO DO MURIAE</option><option value="3612">PEDRA AZUL</option><option value="3618">PEDRA DOURADA</option><option value="3623">PEDRINOPOLIS</option><option value="3624">PEDRO LEOPOLDO</option><option value="3653">PIEDADE DOS GERAIS</option><option value="3657">PINGO-D'AGUA</option><option value="3672">PIRAPETINGA</option><option value="3673">PIRAPORA</option><option value="3677">PITANGUI</option><option value="3686">POCOS DE CALDAS</option><option value="3688">POMPEU</option><option value="3708">POUSO ALEGRE</option><option value="3709">POUSO ALTO</option><option value="3711">PRATA</option><option value="3721">PRUDENTE DE MORAIS</option><option value="3738">RESPLENDOR</option><option value="3743">RIBEIRAO DAS NEVES</option><option value="3749">RIO CASCA</option><option value="3756">RIO NOVO</option><option value="3760">RIO POMBA</option><option value="3778">SABARA</option><option value="3781">SALINAS</option><option value="3783">SALTO DA DIVISA</option><option value="3785">SANTA BARBARA</option><option value="3803">SANTA LUZIA</option><option value="3805">SANTA MARGARIDA</option><option value="3810">SANTA RITA DE CALDAS</option><option value="3818">SANTA RITA DO SAPUCAI</option><option value="3825">SANTA VITORIA</option><option value="3839">SANTANA DO PARAISO</option><option value="3873">SAO BRAS DO SUACUI</option><option value="3880">SAO FELIX DE MINAS</option><option value="3881">SAO FRANCISCO</option><option value="3883">SAO FRANCISCO DE SALES</option><option value="3895">SAO GONCALO DO PARA</option><option value="3896">SAO GONCALO DO RIO ABAIXO</option><option value="3899">SAO GONCALO DO SAPUCAI</option><option value="3913">SAO JOAO DEL REI</option><option value="3918">SAO JOAO DO ORIENTE</option><option value="3922">SAO JOAO NEPOMUCENO</option><option value="3925">SAO JOAQUIM DE BICAS</option><option value="3928">SAO JOSE DA LAPA</option><option value="3948">SAO LOURENCO</option><option value="4043">SETE LAGOAS</option><option value="4063">TAIOBEIRAS</option><option value="4074">TEOFILO OTONI</option><option value="4076">TIMOTEO</option><option value="4083">TOLEDO</option><option value="4089">TRES CORACOES</option><option value="4096">TUPACIGUARA</option><option value="4098">TURMALINA</option><option value="4100">UBA</option><option value="4104">UBERABA</option><option value="4105">UBERLANDIA</option><option value="4121">VARGEM GRANDE DO RIO PARDO</option><option value="4123">VARGINHA</option><option value="4125">VARZEA DA PALMA</option><option value="4138">VESPASIANO</option><option value="4139">VICOSA</option></select>"""
        mgs_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="4164">AMAMBAI</option><option value="4167">ANASTACIO</option><option value="4173">AQUIDAUANA</option><option value="4191">BRASILANDIA</option><option value="4198">CAMPO GRANDE</option><option value="4208">CORONEL SAPUCAIA</option><option value="4209">CORUMBA</option><option value="4210">COSTA RICA</option><option value="4211">COXIM</option><option value="4220">DOURADOS</option><option value="4239">ITAPORA</option><option value="4261">NAVIRAI</option><option value="4265">NOVA ALVORADA DO SUL</option><option value="4297">RIO VERDE DE MATO GROSSO</option><option value="4303">SAO GABRIEL DO OESTE</option><option value="4312">SIDROLANDIA</option><option value="4320">TRES LAGOAS</option></select>"""
        mg_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="4370">CACERES</option><option value="4389">CHAPADA DOS GUIMARAES</option><option value="10176">COLNIZA</option><option value="4395">COMODORO</option><option value="4405">CUIABA</option><option value="4426">GUARANTA DO NORTE</option><option value="4458">NOBRES</option><option value="4476">NOVA OLIMPIA</option><option value="4491">PEDRA PRETA</option><option value="4496">POCONE</option><option value="4510">PRIMAVERA DO LESTE</option><option value="4521">RONDONOPOLIS</option><option value="4570">VARZEA GRANDE</option></select>"""
        para_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="4582">ABAETETUBA</option><option value="4583">ABEL FIGUEIREDO</option><option value="4587">AGUA AZUL DO NORTE</option><option value="4594">ALTAMIRA</option><option value="4599">ANANINDEUA</option><option value="4612">AUGUSTO CORREA</option><option value="4613">AURORA DO PARA</option><option value="4625">BELEM</option><option value="4637">BONITO</option><option value="4638">BRAGANCA</option><option value="4643">BREU BRANCO</option><option value="4644">BREVES</option><option value="4654">CAMETA</option><option value="4656">CANAA DOS CARAJAS</option><option value="4658">CAPITAO POCO</option><option value="4666">CASTANHAL</option><option value="4671">CONCEICAO DO ARAGUAIA</option><option value="4678">CUMARU DO NORTE</option><option value="4679">CURIONOPOLIS</option><option value="4683">CURUCA</option><option value="4686">DOM ELISEU</option><option value="4695">GARRAFAO DO NORTE</option><option value="4696">GOIANESIA DO PARA</option><option value="4710">IPIXUNA DO PARA</option><option value="4712">ITAITUBA</option><option value="4715">ITUPIRANGA</option><option value="4717">JACUNDA</option><option value="4734">MAE DO RIO</option><option value="4738">MARABA</option><option value="4742">MARITUBA</option><option value="4754">MOJU</option><option value="4776">NOVO REPARTIMENTO</option><option value="4780">ORIXIMINA</option><option value="4784">OURILANDIA DO NORTE</option><option value="4788">PALESTINA DO PARA</option><option value="4789">PARAGOMINAS</option><option value="4791">PARAUAPEBAS</option><option value="4815">REDENCAO</option><option value="4825">SANTA BARBARA DO PARA</option><option value="4827">SANTA ISABEL DO PARA</option><option value="4831">SANTA MARIA DO PARA</option><option value="4838">SANTO ANTONIO DO TAUA</option><option value="4840">SAO DOMINGOS DO ARAGUAIA</option><option value="4841">SAO DOMINGOS DO CAPIM</option><option value="4860">SAO MIGUEL DO GUAMA</option><option value="4874">TAILANDIA</option><option value="4880">TERRA SANTA</option><option value="4886">TUCUMA</option><option value="4888">ULIANOPOLIS</option><option value="4889">URUARA</option><option value="4894">VIGIA</option><option value="4909">XINGUARA</option></select>"""
        paraiba_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="4919">ALHANDRA</option><option value="4923">ARARA</option><option value="4924">ARARUNA</option><option value="4938">BARRA DE SANTA ROSA</option><option value="4942">BAYEUX</option><option value="4944">BELEM DO BREJO DO CRUZ</option><option value="4952">BONITO DE SANTA FE</option><option value="4956">BREJO DO CRUZ</option><option value="4960">CABEDELO</option><option value="4970">CAJAZEIRAS</option><option value="4975">CAMPINA GRANDE</option><option value="4988">CATOLE DO ROCHA</option><option value="4994">CONDE</option><option value="5010">DIAMANTE</option><option value="5016">ESPERANCA</option><option value="5025">GUARABIRA</option><option value="5034">ITABAIANA</option><option value="5041">JOAO PESSOA</option><option value="5043">JUAZEIRINHO</option><option value="5045">JURIPIRANGA</option><option value="5048">LAGOA DE DENTRO</option><option value="5055">LUCENA</option><option value="5074">MONTE HOREBE</option><option value="5075">MONTEIRO</option><option value="5092">OURO VELHO</option><option value="5096">PATOS</option><option value="5097">PAULISTA</option><option value="5100">PEDRAS DE FOGO</option><option value="5106">PICUI</option><option value="5107">PILAR</option><option value="5117">POCINHOS</option><option value="5120">POMBAL</option><option value="5124">PRINCESA ISABEL</option><option value="5126">PUXINANA</option><option value="5130">REMIGIO</option><option value="5140">RIO TINTO</option><option value="5151">SANTA LUZIA</option><option value="5154">SANTA RITA</option><option value="16917">SANTA RITA</option><option value="5162">SAO BENTO</option><option value="5177">SAO JOSE DE PIRANHAS</option><option value="5183">SAO JOSE DOS RAMOS</option><option value="5190">SAPE</option><option value="5202">SOLANEA</option><option value="5207">SUME</option></select>"""
        pernambuco_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="5226">ABREU E LIMA</option><option value="5227">AFOGADOS DA INGAZEIRA</option><option value="5232">AGUAS BELAS</option><option value="5234">ALAGOINHA</option><option value="5237">ALIANCA</option><option value="5239">AMARAJI</option><option value="5244">ARARIPINA</option><option value="5245">ARCOVERDE</option><option value="5260">BELO JARDIM</option><option value="5266">BEZERROS</option><option value="5269">BODOCO</option><option value="5270">BOM CONSELHO</option><option value="5279">BUIQUE</option><option value="5282">CABO DE SANTO AGOSTINHO</option><option value="5283">CABROBO</option><option value="5304">CARNAIBA</option><option value="5308">CARPINA</option><option value="5310">CARUARU</option><option value="5312">CATENDE</option><option value="5317">CHA DE ALEGRIA</option><option value="5319">CHA GRANDE</option><option value="5334">CUPIRA</option><option value="5336">CUSTODIA</option><option value="5340">ESCADA</option><option value="5342">EXU</option><option value="5344">FEIRA NOVA</option><option value="5353">GARANHUNS</option><option value="5354">GLORIA DO GOITA</option><option value="5355">GOIANA</option><option value="5358">GRAVATA</option><option value="5364">IATI</option><option value="5375">IGARASSU</option><option value="5376">IGUARACI</option><option value="5387">ILHA DE ITAMARACA</option><option value="5378">INGAZEIRA</option><option value="5379">IPOJUCA</option><option value="5386">ITAIBA</option><option value="5388">ITAMBE</option><option value="5390">ITAPISSUMA</option><option value="5396">JABOATAO DOS GUARARAPES</option><option value="5404">JOAQUIM NABUCO</option><option value="5409">JUPI</option><option value="5410">JUREMA</option><option value="5415">LAGOA DO CARRO</option><option value="5420">LAGOA GRANDE</option><option value="5423">LAJEDO</option><option value="5425">LIMOEIRO</option><option value="5442">MORENO</option><option value="5449">NAZARE DA MATA</option><option value="5456">OLINDA</option><option value="5461">OURICURI</option><option value="5471">PARANATAMA</option><option value="5477">PAUDALHO</option><option value="5478">PAULISTA</option><option value="5481">PESQUEIRA</option><option value="5483">PETROLINA</option><option value="5500">RECIFE</option><option value="5508">SAIRE</option><option value="5510">SALGUEIRO</option><option value="5513">SANHARO</option><option value="5515">SANTA CRUZ DA BAIXA VERDE</option><option value="5516">SANTA CRUZ DO CAPIBARIBE</option><option value="5518">SANTA MARIA DA BOA VISTA</option><option value="5521">SANTA TEREZINHA</option><option value="5536">SAO JOSE DO BELMONTE</option><option value="5539">SAO LOURENCO DA MATA</option><option value="5547">SERRA TALHADA</option><option value="5548">SERRITA</option><option value="5550">SERTANIA</option><option value="5553">SIRINHAEM</option><option value="5556">SURUBIM</option><option value="5557">TABIRA</option><option value="5559">TACAIMBO</option><option value="5561">TAMANDARE</option><option value="5570">TIMBAUBA</option><option value="5576">TRINDADE</option><option value="5579">TUPANATINGA</option><option value="5590">VENTUROSA</option><option value="5594">VICENCIA</option><option value="5597">VITORIA DE SANTO ANTAO</option></select>"""
        piaui_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="5603">AGRICOLANDIA</option><option value="5604">AGUA BRANCA</option><option value="5605">ALAGOINHA DO PIAUI</option><option value="5606">ALEGRETE DO PIAUI</option><option value="5608">ALTOS</option><option value="5622">BARRAS</option><option value="5624">BARRO DURO</option><option value="5627">BELEM DO PIAUI</option><option value="5628">BENEDITINOS</option><option value="5638">BRASILEIRA</option><option value="5652">CAMPO GRANDE DO PIAUI</option><option value="5666">COCAL</option><option value="5683">DEMERVAL LOBAO</option><option value="5694">FLORES DO PIAUI</option><option value="5696">FLORIANO</option><option value="5701">FRONTEIRAS</option><option value="5712">ITAUEIRA</option><option value="5722">JOSE DE FREITAS</option><option value="5726">LAGOA ALEGRE</option><option value="5730">LAGOA DO PIAUI</option><option value="5740">MARCOLANDIA</option><option value="5744">MIGUEL ALVES</option><option value="5747">MONSENHOR GIL</option><option value="5748">MONSENHOR HIPOLITO</option><option value="5764">OEIRAS</option><option value="5767">PAES LANDIM</option><option value="5774">PARNAIBA</option><option value="5778">PAULISTANA</option><option value="5784">PICOS</option><option value="5787">PIRACURUCA</option><option value="5788">PIRIPIRI</option><option value="5816">SAO FRANCISCO DE ASSIS DO PIAUI</option><option value="5834">SAO MIGUEL DO FIDALGO</option><option value="5836">SAO PEDRO DO PIAUI</option><option value="5847">TERESINA</option><option value="5848">UNIAO</option><option value="5849">URUCUI</option><option value="5850">VALENCA DO PIAUI</option><option value="5851">VARZEA BRANCA</option></select>"""
        parana_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="5887">ALTONIA</option><option value="5889">ALVORADA DO SUL</option><option value="5892">AMPERE</option><option value="5906">APUCARANA</option><option value="5909">ARAPONGAS</option><option value="5914">ARARUNA</option><option value="5915">ARAUCARIA</option><option value="5922">ASSAI</option><option value="6016">CAFEZAL DO SUL</option><option value="6038">CAMPO LARGO</option><option value="6068">CASCAVEL</option><option value="6069">CASTRO</option><option value="6087">CIANORTE</option><option value="6088">CIDADE GAUCHA</option><option value="6092">COLOMBO</option><option value="6137">CRUZEIRO DO IGUACU</option><option value="6139">CRUZEIRO DO OESTE</option><option value="6143">CURITIBA</option><option value="6176">ENGENHEIRO BELTRAO</option><option value="6190">FAXINAL</option><option value="6197">FAZENDA RIO GRANDE</option><option value="6211">FLORAI</option><option value="6212">FLORESTA</option><option value="6215">FLORIDA</option><option value="6220">FOZ DO IGUACU</option><option value="6222">FRANCISCO ALVES</option><option value="6223">FRANCISCO BELTRAO</option><option value="6265">GUARATUBA</option><option value="6285">IGUARACU</option><option value="6293">IMBITUVA</option><option value="6316">ITAMBE</option><option value="6330">IVATE</option><option value="6354">JARDIM OLINDA</option><option value="6389">LARANJEIRAS DO SUL</option><option value="6398">LOANDA</option><option value="6400">LONDRINA</option><option value="6413">MAMBORE</option><option value="6415">MANDAGUACU</option><option value="6431">MARIA HELENA</option><option value="6433">MARIALVA</option><option value="6438">MARILUZ</option><option value="6440">MARINGA</option><option value="6451">MARUMBI</option><option value="6453">MATINHOS</option><option value="6496">NOVA ESPERANCA</option><option value="6502">NOVA OLIMPIA</option><option value="6528">PAICANDU</option><option value="6550">PARANAGUA</option><option value="6552">PARANAVAI</option><option value="6559">PATO BRANCO</option><option value="6571">PEROLA</option><option value="6594">PIRAQUARA</option><option value="6605">PONTA GROSSA</option><option value="6606">PONTAL DO PARANA</option><option value="6607">PORECATU</option><option value="6628">PRESIDENTE CASTELO BRANCO</option><option value="6639">QUEDAS DO IGUACU</option><option value="6641">QUERENCIA DO NORTE</option><option value="6689">ROLANDIA</option><option value="6701">SALTO DO ITARARE</option><option value="6725">SANTA MARIA DO OESTE</option><option value="6728">SANTA MONICA</option><option value="6743">SANTO ANTONIO DO CAIUA</option><option value="6794">SAO JOSE DOS PINHAIS</option><option value="6847">SAPOPEMA</option><option value="6848">SARANDI</option><option value="6873">SIQUEIRA CAMPOS</option><option value="6885">TAPEJARA</option><option value="6900">TERRA ROXA</option><option value="6909">TOLEDO</option><option value="6913">TRES BARRAS DO PARANA</option><option value="6934">UMUARAMA</option><option value="6936">UNIAO DA VITORIA</option><option value="6938">UNIFLOR</option></select>"""
        rj_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="6987">ANGRA DOS REIS</option><option value="6990">ARARUAMA</option><option value="6997">BACAXA</option><option value="7005">BARRA DO PIRAI</option><option value="7006">BARRA MANSA</option><option value="7008">BELFORD ROXO</option><option value="7013">BOM JARDIM</option><option value="7016">CABO FRIO</option><option value="7018">CACHOEIRAS DE MACACU</option><option value="7024">CAMPOS DOS GOYTACAZES</option><option value="7026">CANTAGALO</option><option value="7032">CASIMIRO DE ABREU</option><option value="7043">CORDEIRO</option><option value="7055">DUQUE DE CAXIAS</option><option value="7070">GUAPIMIRIM</option><option value="7075">IGUABA GRANDE</option><option value="7084">ITABORAI</option><option value="7086">ITAGUAI</option><option value="7105">MACAE</option><option value="7107">MAGE</option><option value="7109">MANGARATIBA</option><option value="7114">MARICA</option><option value="7116">MESQUITA</option><option value="7117">MIGUEL PEREIRA</option><option value="7131">NILOPOLIS</option><option value="7132">NITEROI</option><option value="7136">NOVA FRIBURGO</option><option value="7137">NOVA IGUACU</option><option value="7150">PATY DO ALFERES</option><option value="7155">PETROPOLIS</option><option value="7160">PIRAI</option><option value="7166">PORTO REAL</option><option value="7174">QUEIMADOS</option><option value="7182">RIO BONITO</option><option value="7185">RIO DAS OSTRAS</option><option value="7186">RIO DE JANEIRO</option><option value="7205">SANTO ANTONIO DE PADUA</option><option value="7209">SAO FRANCISCO DE ITABAPOANA</option><option value="7211">SAO GONCALO</option><option value="7212">SAO JOAO DA BARRA</option><option value="7213">SAO JOAO DE MERITI</option><option value="7222">SAO PEDRO DA ALDEIA</option><option value="7229">SAQUAREMA</option><option value="7239">SUMIDOURO</option><option value="7243">TANGUA</option><option value="7246">TERESOPOLIS</option><option value="7266">VOLTA REDONDA</option></select>"""
        rgn_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="7270">ACU</option><option value="7281">BAIA FORMOSA</option><option value="7283">BARAUNA</option><option value="7289">BOM JESUS</option><option value="7293">CAICO</option><option value="7297">CANGUARETAMA</option><option value="7298">CARAUBAS</option><option value="7300">CARNAUBAIS</option><option value="7301">CEARA-MIRIM</option><option value="7302">CERRO CORA</option><option value="7307">CURRAIS NOVOS</option><option value="7312">EXTREMOZ</option><option value="7313">FELIPE GUERRA</option><option value="7316">FLORANIA</option><option value="7323">GROSSOS</option><option value="7327">IPANGUACU</option><option value="7330">ITAJA</option><option value="7331">ITAU</option><option value="7334">JANDUIS</option><option value="7340">JOAO CAMARA</option><option value="7354">MACAIBA</option><option value="7355">MACAU</option><option value="7359">MARTINS</option><option value="7362">MESSIAS TARGINO</option><option value="7364">MONTE ALEGRE</option><option value="7366">MOSSORO</option><option value="7367">NATAL</option><option value="7368">NISIA FLORESTA</option><option value="7374">PARAU</option><option value="7376">PARELHAS</option><option value="7377">PARNAMIRIM</option><option value="7381">PAU DOS FERROS</option><option value="7386">PENDENCIAS</option><option value="7388">POCO BRANCO</option><option value="7399">RODOLFO FERNANDES</option><option value="7405">SANTA MARIA</option><option value="7409">SANTO ANTONIO</option><option value="7417">SAO GONCALO DO AMARANTE</option><option value="7420">SAO JOSE DE MIPIBU</option><option value="7429">SAO VICENTE</option><option value="7436">SERRA DO MEL</option><option value="19840">SERRINHA</option><option value="7443">TAIPU</option><option value="7444">TANGARA</option><option value="7446">TENENTE LAURENTINO CRUZ</option><option value="7447">TIBAU</option><option value="7450">TOUROS</option><option value="7452">TRIUNFO POTIGUAR</option><option value="7454">UPANEMA</option></select>"""
        rgs_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="7555">AGUDO</option><option value="7571">ALVORADA</option><option value="7588">ARROIO DO TIGRE</option><option value="7590">ARROIO GRANDE</option><option value="7594">ARVOREZINHA</option><option value="7602">BAGE</option><option value="7612">BARRA DO RIBEIRO</option><option value="7629">BENTO GONCALVES</option><option value="7649">BOM RETIRO DO SUL</option><option value="7666">CACHOEIRINHA</option><option value="7671">CAMAQUA</option><option value="7681">CAMPO BOM</option><option value="7697">CANOAS</option><option value="7703">CAPAO DA CANOA</option><option value="7707">CAPAO DO LEAO</option><option value="7708">CAPELA DE SANTANA</option><option value="7716">CARAA</option><option value="7718">CARAZINHO</option><option value="7719">CARLOS BARBOSA</option><option value="7730">CAXIAS DO SUL</option><option value="7749">CHARQUEADAS</option><option value="7793">CRISSIUMAL</option><option value="7829">DOUTOR RICARDO</option><option value="7830">ELDORADO DO SUL</option><option value="7834">ENCRUZILHADA DO SUL</option><option value="7840">ERECHIM</option><option value="7862">ESTANCIA VELHA</option><option value="7863">ESTEIO</option><option value="7876">FARROUPILHA</option><option value="7883">FELIZ</option><option value="7896">FREDERICO WESTPHALEN</option><option value="7899">GARIBALDI</option><option value="7903">GENERAL CAMARA</option><option value="7910">GRAMADO</option><option value="7914">GRAVATAI</option><option value="7916">GUAIBA</option><option value="7918">GUAPORE</option><option value="7925">HORIZONTINA</option><option value="7928">IBARAMA</option><option value="7934">IGREJINHA</option><option value="7940">IMBE</option><option value="7950">ITAARA</option><option value="7960">ITAQUI</option><option value="7970">JACUTINGA</option><option value="7971">JAGUARAO</option><option value="7988">LAGOAO</option><option value="7989">LAJEADO</option><option value="7999">LAVRAS DO SUL</option><option value="8017">MARCELINO RAMOS</option><option value="8046">MONTENEGRO</option><option value="8053">MORRO REUTER</option><option value="8055">MOSTARDAS</option><option value="8067">NOVA BASSANO</option><option value="8069">NOVA BRESCIA</option><option value="8084">NOVO HAMBURGO</option><option value="8101">PALMEIRA DAS MISSOES</option><option value="8104">PANAMBI</option><option value="8109">PAROBE</option><option value="8119">PASSO FUNDO</option><option value="8124">PAVERAMA</option><option value="8131">PELOTAS</option><option value="8159">PORTAO</option><option value="8160">PORTO ALEGRE</option><option value="8179">QUARAI</option><option value="8207">RIO GRANDE</option><option value="8213">RIOZINHO</option><option value="8220">RONDINHA</option><option value="8267">SANT' ANA DO LIVRAMENTO</option><option value="8237">SANTA BARBARA DO SUL</option><option value="8245">SANTA CRUZ DO SUL</option><option value="8253">SANTA MARIA</option><option value="8256">SANTA ROSA</option><option value="8262">SANTA VITORIA DO PALMAR</option><option value="8270">SANTO ANGELO</option><option value="8274">SANTO ANTONIO DA PATRULHA</option><option value="8280">SANTO AUGUSTO</option><option value="8281">SANTO CRISTO</option><option value="8286">SAO BORJA</option><option value="8292">SAO GABRIEL</option><option value="8293">SAO JERONIMO</option><option value="8312">SAO LEOPOLDO</option><option value="8321">SAO MARTINHO</option><option value="8337">SAO SEBASTIAO DO CAI</option><option value="8347">SAPUCAIA DO SUL</option><option value="8348">SARANDI</option><option value="8389">TAPEJARA</option><option value="8392">TAPES</option><option value="8399">TERRA DE AREIA</option><option value="8401">TEUTONIA</option><option value="8411">TRAMANDAI</option><option value="8425">TRIUNFO</option><option value="8447">VACARIA</option><option value="8455">VENANCIO AIRES</option><option value="8461">VIAMAO</option><option value="8484">XANGRI-LA</option></select>"""
        rondonia_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="7462">ALTA FLORESTA D'OESTE</option><option value="7469">ARIQUEMES</option><option value="7474">CACOAL</option><option value="7477">CANDEIAS DO JAMARI</option><option value="7486">ESPIGAO D'OESTE</option><option value="7489">GUAJARA-MIRIM</option><option value="7495">JI-PARANA</option><option value="7496">MACHADINHO D'OESTE</option><option value="7502">NOVA MAMORE</option><option value="7506">OURO PRETO DO OESTE</option><option value="7512">PORTO VELHO</option><option value="7513">PRESIDENTE MEDICI</option><option value="7518">ROLIM DE MOURA</option><option value="7521">SAO FELIPE D'OESTE</option><option value="7529">URUPA</option><option value="7534">VILHENA</option></select>"""
        roraima_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="7538">BOA VISTA</option><option value="7539">BONFIM</option><option value="7547">RORAINOPOLIS</option></select>"""
        sc_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="8498">ALFREDO WAGNER</option><option value="8512">ARMAZEM</option><option value="8522">BALNEARIO ARROIO DO SILVA</option><option value="8544">BIGUACU</option><option value="8545">BLUMENAU</option><option value="8555">BRACO DO NORTE</option><option value="8575">CANOINHAS</option><option value="8592">CONCORDIA</option><option value="8593">CORDILHEIRA ALTA</option><option value="8598">CRICIUMA</option><option value="8605">DIONISIO CERQUEIRA</option><option value="8616">FAXINAL DOS GUEDES</option><option value="8621">FLORIANOPOLIS</option><option value="8630">GAROPABA</option><option value="8632">GASPAR</option><option value="8641">GUARAMIRIM</option><option value="8651">IBIRAMA</option><option value="8676">ITAJAI</option><option value="8680">ITAPOA</option><option value="8687">JARAGUA DO SUL</option><option value="8690">JOINVILLE</option><option value="8694">LAGES</option><option value="8700">LAURO MULLER</option><option value="8713">MAFRA</option><option value="8726">MASSARANDUBA</option><option value="8742">NAVEGANTES</option><option value="8747">NOVA ITABERABA</option><option value="8755">OTACILIO COSTA</option><option value="8761">PALHOCA</option><option value="8762">PALMA SOLA</option><option value="8781">PINHALZINHO</option><option value="8795">PORTO UNIAO</option><option value="8822">RIO DO SUL</option><option value="8856">SAO BENTO DO SUL</option><option value="8863">SAO DOMINGOS</option><option value="8873">SAO JOSE</option><option value="8901">TAIO</option></select>"""
        sergipe_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="8944">ARACAJU</option><option value="8948">BARRA DOS COQUEIROS</option><option value="8950">BOQUIM</option><option value="8953">CAMPO DO BRITO</option><option value="8955">CANINDE DE SAO FRANCISCO</option><option value="8956">CAPELA</option><option value="8960">CRISTINAPOLIS</option><option value="8961">CUMBE</option><option value="8963">ESTANCIA</option><option value="8964">FEIRA NOVA</option><option value="8965">FREI PAULO</option><option value="8972">ITABAIANA</option><option value="8973">ITABAIANINHA</option><option value="8975">ITAPORANGA D'AJUDA</option><option value="8978">LAGARTO</option><option value="8982">MALHADA DOS BOIS</option><option value="8983">MALHADOR</option><option value="8987">MONTE ALEGRE DE SERGIPE</option><option value="8989">MURIBECA</option><option value="8993">NOSSA SENHORA DAS DORES</option><option value="8995">NOSSA SENHORA DO SOCORRO</option><option value="9000">PEDRINHAS</option><option value="9003">POCO REDONDO</option><option value="9004">POCO VERDE</option><option value="9005">PORTO DA FOLHA</option><option value="9006">PROPRIA</option><option value="9009">RIBEIROPOLIS</option><option value="9018">SAO CRISTOVAO</option><option value="9024">SIMAO DIAS</option><option value="9025">SIRIRI</option><option value="9027">TOBIAS BARRETO</option><option value="9028">TOMAR DO GERU</option><option value="9029">UMBAUBA</option></select>"""
        sp_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="8944">ARACAJU</option><option value="8948">BARRA DOS COQUEIROS</option><option value="8950">BOQUIM</option><option value="8953">CAMPO DO BRITO</option><option value="8955">CANINDE DE SAO FRANCISCO</option><option value="8956">CAPELA</option><option value="8960">CRISTINAPOLIS</option><option value="8961">CUMBE</option><option value="8963">ESTANCIA</option><option value="8964">FEIRA NOVA</option><option value="8965">FREI PAULO</option><option value="8972">ITABAIANA</option><option value="8973">ITABAIANINHA</option><option value="8975">ITAPORANGA D'AJUDA</option><option value="8978">LAGARTO</option><option value="8982">MALHADA DOS BOIS</option><option value="8983">MALHADOR</option><option value="8987">MONTE ALEGRE DE SERGIPE</option><option value="8989">MURIBECA</option><option value="8993">NOSSA SENHORA DAS DORES</option><option value="8995">NOSSA SENHORA DO SOCORRO</option><option value="9000">PEDRINHAS</option><option value="9003">POCO REDONDO</option><option value="9004">POCO VERDE</option><option value="9005">PORTO DA FOLHA</option><option value="9006">PROPRIA</option><option value="9009">RIBEIROPOLIS</option><option value="9018">SAO CRISTOVAO</option><option value="9024">SIMAO DIAS</option><option value="9025">SIRIRI</option><option value="9027">TOBIAS BARRETO</option><option value="9028">TOMAR DO GERU</option><option value="9029">UMBAUBA</option></select>"""
        tocantins_opt = """<select class="select-d input-non-fluid" id="cmb_cidade" name="cmb_cidade" title="Selecione a Cidade" onchange="carregaListaBairros()" style="opacity: 0;"><option value="">Selecione</option><option value="9999">ARAGUAINA</option><option value="10001">ARAGUATINS</option><option value="10034">COMBINADO</option><option value="10044">DIANOPOLIS</option><option value="10057">GUARAI</option><option value="10079">MIRANORTE</option><option value="10095">PALMAS</option><option value="10117">PORTO NACIONAL</option><option value="10135">SAO BENTO DO TOCANTINS</option><option value="10151">TOCANTINOPOLIS</option></select>"""

        acre_cities_id = self.parse_select_dict(acre_opt)
        alagoas_cities_id = self.parse_select_dict(raw_select=alagoas_opt)
        amapa_cities_id = self.parse_select_dict(raw_select=amapa_opt)
        amazonas_cities_id = self.parse_select_dict(raw_select=amazonas_opt)
        bahia_cities_id = self.parse_select_dict(raw_select=bahia_opt)
        ceara_cities_id = self.parse_select_dict(raw_select=ceara_opt)
        df_cities_id = self.parse_select_dict(raw_select=df_opt)
        es_cities_id = self.parse_select_dict(raw_select=es_opt)
        goias_cities_id = self.parse_select_dict(raw_select=goias_opt)
        maranhao_cities_id = self.parse_select_dict(raw_select=maranhao_opt)
        mg_cities_id = self.parse_select_dict(raw_select=mg_opt)
        mgs_cities_id = self.parse_select_dict(raw_select=mgs_opt)
        minas_gerais_cities_id = self.parse_select_dict(raw_select=minas_gerais_opt)
        para_cities_id = self.parse_select_dict(raw_select=para_opt)
        paraiba_cities_id = self.parse_select_dict(raw_select=paraiba_opt)
        parana_cities_id = self.parse_select_dict(raw_select=parana_opt)
        pernambuco_cities_id = self.parse_select_dict(raw_select=pernambuco_opt)
        piaui_cities_id = self.parse_select_dict(raw_select=piaui_opt)
        rj_cities_id = self.parse_select_dict(raw_select=rj_opt)
        rgn_cities_id = self.parse_select_dict(raw_select=rgn_opt)
        rgs_cities_id = self.parse_select_dict(raw_select=rgs_opt)
        rondonia_cities_id = self.parse_select_dict(raw_select=rondonia_opt)
        roraima_cities_id = self.parse_select_dict(raw_select=roraima_opt)
        sc_cities_id = self.parse_select_dict(raw_select=sc_opt)
        sp_cities_id = self.parse_select_dict(raw_select=sp_opt)
        sergipe_cities_id = self.parse_select_dict(raw_select=sergipe_opt)
        tocantins_cities_id = self.parse_select_dict(raw_select=tocantins_opt)

        return {
            states_id['acre']: acre_cities_id,
            states_id['alagoas']: alagoas_cities_id,
            states_id['amapa']: amapa_cities_id,
            states_id['amazonas']: amazonas_cities_id,
            states_id['bahia']: bahia_cities_id,
            states_id['ceara']: ceara_cities_id,
            states_id['distrito_federal']: df_cities_id,
            states_id['espirito_santo']: es_cities_id,
            states_id['goias']: goias_cities_id,
            states_id['maranhao']: maranhao_cities_id,
            states_id['mato_grosso']: mg_cities_id,
            states_id['mato_grosso_do_sul']: mgs_cities_id,
            states_id['minas_gerais']: minas_gerais_cities_id,
            states_id['para']: para_cities_id,
            states_id['paraiba']: paraiba_cities_id,
            states_id['parana']: parana_cities_id,
            states_id['pernambuco']: pernambuco_cities_id,
            states_id['piaui']: piaui_cities_id,
            states_id['rio_de_janeiro']: rj_cities_id,
            states_id['rio_grande_do_norte']: rgn_cities_id,
            states_id['rio_grande_do_sul']: rgs_cities_id,
            states_id['rondonia']: rondonia_cities_id,
            states_id['roraima']: roraima_cities_id,
            states_id['santa_catarina']: sc_cities_id,
            states_id['sao_paulo']: sp_cities_id,
            states_id['sergipe']: sergipe_cities_id,
            states_id['tocantins']: tocantins_cities_id,
        }

    def get_city_slug(self, chosen_city):
        url = "https://q3jhhgksa9.execute-api.us-east-2.amazonaws.com/prod/city"

        payload = ""
        headers = {"x-api-key": "TFqvYJxuhO67Bo5WOzspQ6UENhuIZFVvrhLIcCig"}
        response = requests.request("GET", url, data=payload, headers=headers)
        cities = json.loads(response.text)
        for city in cities:
            normalized_city = self.normalize_string(city['name'])
            if normalized_city == chosen_city:
                return city['slug']

    def get_cities(self, estado, cidade):
        url = "https://venda-imoveis.caixa.gov.br/sistema/carregaPesquisaImoveis.asp"

        payload = f"hdn_estado={estado}&hdn_cidade={cidade}"
        headers = {
            "cookie": "ASPSESSIONIDCABSCDSD=KNFMIJHBKOILHLLICEJEEBKC; ARRAffinity01=247fcabb6813a9f5eb4d7cfdc27ce23da9932e836f0a4a4de5afc1d98864267d; UqZBpD3n3kS4aGYulCWJiSbNcs42xA__=v1LfZXgw__8oc",
            "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8"
        }

        response = requests.request("POST", url, data=payload, headers=headers)
        response = Selector(text=response.text)

        return response.xpath('//input/@value').get()

    def get_url(self):

        global estado, cidade
        for state_id, state_cities in self.states_city_for_each_state.items():
            for city, city_id in state_cities.items():
                if city == self.city:
                    estado = state_id
                    cidade = city_id

        value = self.get_cities(estado=estado, cidade=cidade)

        url = "https://venda-imoveis.caixa.gov.br/sistema/carregaListaImoveis.asp"

        payload = f"hdnImov={value}"
        headers = {
            "cookie": "ASPSESSIONIDCABSCDSD=KNFMIJHBKOILHLLICEJEEBKC; ARRAffinity01=247fcabb6813a9f5eb4d7cfdc27ce23da9932e836f0a4a4de5afc1d98864267d; UqZBpD3n3kS4aGYulCWJiSbNcs42xA__=v1LfZXgw__8oc",
            "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8"
        }

        return requests.request("POST", url, data=payload, headers=headers)

    def parse(self, response):
        site = 'Caixa'
        response = Selector(text=response.text)
        price = ''
        for index, value in enumerate(response.xpath('//font')):
            mod = index % 3
            if mod == 1:
                price = self.clean_html_tags_from_string(
                    value.get().partition('mínimo de venda: ')[-1].split('(')[0])
            elif mod == 2:
                description = self.clean_html_tags_from_string(value.get())
                url = '-'
                item = {
                    'site': site,
                    'price': price,
                    'url': url,
                    'description': description
                }
                if self.city in parser.normalize_string(item['description']) or self.city in parser.normalize_string(item['url']):
                    self.write_csv(csv_file=csv_file, item=item)


if __name__ == '__main__':
    city = sys.argv[1]
    csv_file = sys.argv[2]
    Caixa(city, csv_file)
